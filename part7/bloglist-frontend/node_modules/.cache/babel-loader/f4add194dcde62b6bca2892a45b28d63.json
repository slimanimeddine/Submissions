{"ast":null,"code":"var _jsxFileName = \"/home/slimanimeddine/devstuff/Submissions/part7/bloglist-frontend/src/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport Blog from './components/Blog';\nimport Notification from './components/Notification';\nimport BlogForm from './components/BlogForm';\nimport Togglable from './components/Togglable';\nimport blogService from './services/blogs';\nimport loginService from './services/login';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst App = () => {\n  _s();\n\n  const [blogs, setBlogs] = useState([]);\n  const [user, setUser] = useState(null);\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [notifMessage, setNotificationMessage] = useState('');\n  const [notifClassname, setNotifClassname] = useState('');\n  useEffect(() => {\n    const fetchData = async () => {\n      const blogs = await blogService.getAll();\n      setBlogs(blogs);\n    };\n\n    fetchData();\n  }, []);\n  useEffect(() => {\n    const loggedUserJSON = window.localStorage.getItem('loggedUser');\n\n    if (loggedUserJSON) {\n      const user = JSON.parse(loggedUserJSON);\n      setUser(user);\n      blogService.setToken(user.token);\n    }\n  }, []);\n\n  const handleLogin = async event => {\n    event.preventDefault();\n\n    try {\n      const user = await loginService.login({\n        username,\n        password\n      });\n      blogService.setToken(user.token);\n      window.localStorage.setItem('loggedUser', JSON.stringify(user));\n      setUser(user);\n      setUsername('');\n      setPassword('');\n      setNotificationMessage(`${user.name} logged in successfully`);\n      setNotifClassname('success');\n      setTimeout(() => {\n        setNotificationMessage(null);\n        setNotifClassname(null);\n      }, 5000);\n    } catch (error) {\n      setNotificationMessage('wrong username or password');\n      setNotifClassname('error');\n      setTimeout(() => {\n        setNotificationMessage(null);\n        setNotifClassname(null);\n      }, 5000);\n    }\n  };\n\n  const logout = () => {\n    const confirmLogout = window.confirm('Are you sure?');\n\n    if (confirmLogout) {\n      window.localStorage.removeItem('loggedUser');\n      user.set(null);\n    }\n  };\n\n  const loginForm = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"log in to application\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleLogin,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"username\", /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"username\",\n          value: username,\n          name: \"username\",\n          onChange: _ref => {\n            let {\n              target\n            } = _ref;\n            return setUsername(target.value);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"password\", /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          id: \"password\",\n          value: password,\n          name: \"password\",\n          onChange: _ref2 => {\n            let {\n              target\n            } = _ref2;\n            return setPassword(target.value);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        id: \"login-button\",\n        type: \"submit\",\n        children: \"login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 9\n  }, this);\n\n  const addBlog = async blogObject => {\n    try {\n      const addedBlog = await blogService.create(blogObject);\n      setBlogs(blogs.concat(addedBlog));\n      setNotificationMessage(`a new blog ${addedBlog.title} added`);\n      setNotifClassname('success');\n      setTimeout(() => {\n        setNotificationMessage(null);\n        setNotifClassname(null);\n      }, 5000);\n    } catch (error) {\n      setNotificationMessage(`${error.message}`);\n      setNotifClassname('error');\n      setTimeout(() => {\n        setNotificationMessage(null);\n        setNotifClassname(null);\n      }, 5000);\n    }\n  };\n\n  const incLikes = async id => {\n    const blog = blogs.find(b => b.id === id);\n    const modifiedBlog = { ...blog,\n      likes: blog.likes + 1,\n      user: user.id\n    };\n\n    try {\n      const returnedBlog = await blogService.update(id, modifiedBlog);\n      setBlogs(blogs.map(b => b.id !== id ? b : returnedBlog));\n    } catch (error) {\n      setNotificationMessage(error.message);\n      setNotifClassname('error');\n      setTimeout(() => {\n        setNotificationMessage(null);\n        setNotifClassname(null);\n      }, 5000);\n    }\n  };\n\n  const removeBlog = async id => {\n    const blogToRemove = blogs.find(b => b.id === id);\n    const ok = window.confirm(`remove blog ${blogToRemove.title} by ${blogToRemove.author}`);\n\n    if (ok) {\n      try {\n        await blogService.remove(id);\n        setBlogs(blogs.filter(b => b.id !== id));\n        setNotificationMessage('blog was removed successfully');\n        setNotifClassname('success');\n        setTimeout(() => {\n          setNotificationMessage(null);\n          setNotifClassname(null);\n        }, 5000);\n      } catch (error) {\n        setNotificationMessage(error.message);\n        setNotifClassname('error');\n        setTimeout(() => {\n          setNotificationMessage(null);\n          setNotifClassname(null);\n        }, 5000);\n      }\n    }\n  };\n\n  const blogForm = () => /*#__PURE__*/_jsxDEV(Togglable, {\n    buttonLabel: \"create new blog\",\n    children: /*#__PURE__*/_jsxDEV(BlogForm, {\n      createBlog: addBlog\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 165,\n    columnNumber: 9\n  }, this);\n\n  const showUser = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Blogs\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [user.name, \" logged in\", /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: logout,\n        children: \"logout\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }, this), blogForm(), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: blogs.sort((a, b) => b.likes - a.likes).map(blog => {\n        var _user$username, _blog$user, _blog$user$username;\n\n        return /*#__PURE__*/_jsxDEV(Blog, {\n          title: blog.title,\n          author: blog.author,\n          url: blog.url,\n          likes: blog.likes,\n          name: blog.user.name,\n          incLikes: () => incLikes(blog.id),\n          removeBlog: () => removeBlog(blog.id),\n          isRemovable: (user === null || user === void 0 ? void 0 : (_user$username = user.username) === null || _user$username === void 0 ? void 0 : _user$username.toString()) === (blog === null || blog === void 0 ? void 0 : (_blog$user = blog.user) === null || _blog$user === void 0 ? void 0 : (_blog$user$username = _blog$user.username) === null || _blog$user$username === void 0 ? void 0 : _blog$user$username.toString())\n        }, blog.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 29\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 173,\n    columnNumber: 9\n  }, this);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Notification, {\n      message: notifMessage,\n      classname: notifClassname\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 13\n    }, this), user === null ? loginForm() : showUser()]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 204,\n    columnNumber: 9\n  }, this);\n};\n\n_s(App, \"ca5KJs50XOCGBeTfCJzMv3ljDrA=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/home/slimanimeddine/devstuff/Submissions/part7/bloglist-frontend/src/App.js"],"names":["React","useState","useEffect","Blog","Notification","BlogForm","Togglable","blogService","loginService","App","blogs","setBlogs","user","setUser","username","setUsername","password","setPassword","notifMessage","setNotificationMessage","notifClassname","setNotifClassname","fetchData","getAll","loggedUserJSON","window","localStorage","getItem","JSON","parse","setToken","token","handleLogin","event","preventDefault","login","setItem","stringify","name","setTimeout","error","logout","confirmLogout","confirm","removeItem","set","loginForm","target","value","addBlog","blogObject","addedBlog","create","concat","title","message","incLikes","id","blog","find","b","modifiedBlog","likes","returnedBlog","update","map","removeBlog","blogToRemove","ok","author","remove","filter","blogForm","showUser","sort","a","url","toString"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\nimport Blog from './components/Blog'\nimport Notification from './components/Notification'\nimport BlogForm from './components/BlogForm'\nimport Togglable from './components/Togglable'\nimport blogService from './services/blogs'\nimport loginService from './services/login'\n\nconst App = () => {\n    const [blogs, setBlogs] = useState([])\n    const [user, setUser] = useState(null)\n    const [username, setUsername] = useState('')\n    const [password, setPassword] = useState('')\n    const [notifMessage, setNotificationMessage] = useState('')\n    const [notifClassname, setNotifClassname] = useState('')\n\n    useEffect(() => {\n        const fetchData = async () => {\n            const blogs = await blogService.getAll()\n            setBlogs(blogs)\n        }\n\n        fetchData()\n    }, [])\n\n    useEffect(() => {\n        const loggedUserJSON = window.localStorage.getItem('loggedUser')\n        if (loggedUserJSON) {\n            const user = JSON.parse(loggedUserJSON)\n            setUser(user)\n            blogService.setToken(user.token)\n        }\n    }, [])\n\n    const handleLogin = async event => {\n        event.preventDefault()\n\n        try {\n            const user = await loginService.login({\n                username, password\n            })\n\n            blogService.setToken(user.token)\n            window.localStorage.setItem('loggedUser', JSON.stringify(user))\n            setUser(user)\n            setUsername('')\n            setPassword('')\n            setNotificationMessage(`${user.name} logged in successfully`)\n            setNotifClassname('success')   \n            setTimeout(() => {\n                setNotificationMessage(null)\n                setNotifClassname(null)   \n            }, 5000)\n        } catch (error) {\n            setNotificationMessage('wrong username or password')\n            setNotifClassname('error')   \n            setTimeout(() => {\n                setNotificationMessage(null)\n                setNotifClassname(null)   \n            }, 5000)\n\n        }\n    }\n\n    const logout = () => {\n        const confirmLogout = window.confirm('Are you sure?')\n        if (confirmLogout) {\n            window.localStorage.removeItem('loggedUser')\n            user.set(null)\n        }\n    }\n\n    const loginForm = () => (\n        <div>\n            <h1>log in to application</h1>\n            <form onSubmit={handleLogin}>\n                <div>\n          username\n                    <input\n                        type='text'\n                        id='username'\n                        value={username}\n                        name='username'\n                        onChange={({target}) => setUsername(target.value)}\n                    />\n                </div>\n                <div>\n          password\n                    <input\n                        type='password'\n                        id='password'\n                        value={password}\n                        name='password'\n                        onChange={({target}) => setPassword(target.value)}\n                    />\n                </div>\n                <button id='login-button' type='submit'>login</button>\n            </form>\n        </div>\n    )\n\n    const addBlog = async blogObject => {\n        try {\n            const addedBlog = await blogService.create(blogObject)\n            setBlogs(blogs.concat(addedBlog))\n            setNotificationMessage(`a new blog ${addedBlog.title} added`)\n            setNotifClassname('success')   \n            setTimeout(() => {\n                setNotificationMessage(null)\n                setNotifClassname(null)   \n            }, 5000)\n        } catch (error) {\n            setNotificationMessage(`${error.message}`)\n            setNotifClassname('error')   \n            setTimeout(() => {\n                setNotificationMessage(null)\n                setNotifClassname(null)   \n            }, 5000)      \n        }\n    }\n\n    const incLikes = async id => {\n        const blog = blogs.find(b => b.id === id)\n        const modifiedBlog = {...blog, likes: blog.likes + 1, user: user.id}\n\n        try {\n            const returnedBlog = await blogService.update(id, modifiedBlog)\n            setBlogs(blogs.map(b => b.id !== id ? b : returnedBlog))\n        } catch (error) {\n            setNotificationMessage(error.message)\n            setNotifClassname('error')\n            setTimeout(() => {\n                setNotificationMessage(null)\n                setNotifClassname(null)          \n            }, 5000)\n        }\n    }\n\n    const removeBlog = async id => {\n        const blogToRemove = blogs.find(b => b.id === id)\n        const ok = window.confirm(`remove blog ${blogToRemove.title} by ${blogToRemove.author}`)\n\n        if (ok) {\n            try {\n                await blogService.remove(id)\n                setBlogs(blogs.filter(b => b.id !== id))\n                setNotificationMessage('blog was removed successfully')\n                setNotifClassname('success')\n                setTimeout(() => {\n                    setNotificationMessage(null)\n                    setNotifClassname(null)          \n                }, 5000)              \n            } catch (error) {\n                setNotificationMessage(error.message)\n                setNotifClassname('error')\n                setTimeout(() => {\n                    setNotificationMessage(null)\n                    setNotifClassname(null)          \n                }, 5000)      \n            }  \n        }\n    }\n\n    const blogForm = () => (\n        <Togglable buttonLabel='create new blog'>\n            <BlogForm\n                createBlog={addBlog}\n            />\n        </Togglable>\n    )\n\n    const showUser = () => (\n        <div>\n            <h1>Blogs</h1>     \n            <div>\n                {user.name} logged in \n                <button onClick={logout}>logout</button>\n            </div> \n            {blogForm()}\n            <div>\n                {\n                    blogs\n                        .sort((a, b) => b.likes - a.likes)\n                        .map(blog => \n                            <Blog\n                                key={blog.id}\n                                title={blog.title}\n                                author={blog.author}\n                                url={blog.url}\n                                likes={blog.likes}\n                                name={blog.user.name}\n                                incLikes={() => incLikes(blog.id)}\n                                removeBlog={() => removeBlog(blog.id)}\n                                isRemovable={user?.username?.toString() === blog?.user?.username?.toString()}\n                            />\n                        )\n                }\n            </div>\n        </div>\n    )\n\n\n    return (\n        <div>\n            <Notification message={notifMessage} classname={notifClassname} /> \n            {\n                user === null \n                    ? loginForm()\n                    : showUser() \n            }\n        </div>\n    )\n}\n\nexport default App\n"]},"metadata":{},"sourceType":"module"}